<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Simple Earning App</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase CDN -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

<style>
body{
  font-family: Arial;
  background:#f2f2f2;
  text-align:center;
  padding:20px;
}
.box{
  background:white;
  padding:20px;
  border-radius:10px;
  margin-bottom:15px;
}
button{
  padding:15px;
  width:100%;
  border:none;
  background:#27ae60;
  color:white;
  font-size:16px;
  border-radius:8px;
}
input{
  padding:12px;
  width:90%;
  margin:5px 0;
}
.hidden{display:none;}
</style>
</head>

<body>

<h2>ðŸ’° Simple Earning App</h2>

<!-- LOGIN PAGE -->
<div id="loginBox" class="box">
  <h3>Login / Signup</h3>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">Login / Signup</button>
</div>

<!-- APP PAGE -->
<div id="appBox" class="hidden">

  <div class="box">
    <h3>Balance</h3>
    <h1>â‚¹ <span id="bal">0</span></h1>
  </div>

  <div class="box">
    <h3>Task 1</h3>
    <button onclick="earn(2)">Click & Earn â‚¹2</button>
  </div>

  <div class="box">
    <h3>Task 2</h3>
    <button onclick="earn(5)">Watch & Earn â‚¹5</button>
  </div>

  <div class="box">
    <h3>Withdraw</h3>
    <input id="upi" placeholder="Enter UPI ID">
    <button onclick="withdraw()">Withdraw â‚¹50</button>
  </div>

  <div class="box">
    <button style="background:#e74c3c" onclick="logout()">Logout</button>
  </div>

</div>

<script>
/* ðŸ”¥ Firebase Config */
const firebaseConfig = {
  apiKey: "AIzaSyCPXY9pfY2vrKNEOgenBkYpQqa2SSUQLTk",
  authDomain: "talks-b6037.firebaseapp.com",
  databaseURL: "https://talks-b6037-default-rtdb.firebaseio.com",
  projectId: "talks-b6037",
  storageBucket: "talks-b6037.appspot.com",
  messagingSenderId: "231660762364",
  appId: "1:231660762364:web:e1a9589b00d11221d0d379"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

let currentUser = null;
let balance = 0;

/* ðŸ” Login / Signup */
function login(){
  let email = emailInput.value;
  let pass = password.value;

  auth.signInWithEmailAndPassword(email, pass)
  .catch(()=>{
    return auth.createUserWithEmailAndPassword(email, pass);
  });
}

auth.onAuthStateChanged(user=>{
  if(user){
    currentUser = user;
    loginBox.classList.add("hidden");
    appBox.classList.remove("hidden");

    db.ref("users/"+user.uid).once("value", snap=>{
      if(snap.exists()){
        balance = snap.val().balance;
      }else{
        balance = 0;
        db.ref("users/"+user.uid).set({balance:0});
      }
      bal.innerText = balance;
    });
  }
});

/* ðŸ’° Earn */
function earn(amount){
  balance += amount;
  bal.innerText = balance;
  db.ref("users/"+currentUser.uid).update({balance});
  alert("â‚¹"+amount+" added!");
}

/* ðŸ’¸ Withdraw */
function withdraw(){
  let upi = document.getElementById("upi").value;
  if(!upi) return alert("UPI ID daalo");
  if(balance < 50) return alert("Minimum â‚¹50 chahiye");

  balance -= 50;
  bal.innerText = balance;

  db.ref("withdraws").push({
    user: currentUser.email,
    upi: upi,
    amount: 50,
    status: "Pending",
    time: Date.now()
  });

  db.ref("users/"+currentUser.uid).update({balance});
  alert("Withdraw request sent!");
}

/* ðŸšª Logout */
function logout(){
  auth.signOut();
  location.reload();
}
</script>

</body>
</html>

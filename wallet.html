<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Wallet</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#f2f2f2}
.header{background:#16a085;color:#fff;padding:16px;text-align:center;font-size:20px}
.box{background:#fff;margin:15px;padding:16px;border-radius:14px;box-shadow:0 4px 10px rgba(0,0,0,.15)}
.row{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.btn{background:#2ecc71;color:#fff;border:none;border-radius:20px;padding:8px 16px}
.btn:active{transform:scale(.95)}

.popup{position:fixed;top:0;left:0;width:100%;height:100%;
background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center}

.card{background:#fff;width:85%;padding:20px;border-radius:14px;text-align:center}

input,select{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid #ccc}

.spinner{width:40px;height:40px;border:4px solid #ddd;border-top:4px solid #16a085;
border-radius:50%;animation:spin 1s linear infinite;margin:auto}
@keyframes spin{100%{transform:rotate(360deg)}}

.pending{color:orange}
.success{color:green}
.fail{color:red}
</style>
</head>

<body>

<div class="header">üíº Wallet</div>

<div class="box">
<b>üí∞ Current Balance:</b> <span id="balance">‚Çπ0</span>
</div>

<div class="box" id="withdraw-options"></div>

<!-- PAYMENT POPUP -->
<div class="popup" id="payPopup">
  <div class="card">
    <h3>üè¶ Withdraw Details</h3>

    <select id="method">
      <option value="">Select Method</option>
      <option>UPI</option>
      <option>Paytm</option>
      <option>PhonePe</option>
      <option>Google Pay</option>
    </select>

    <input id="upiId" placeholder="Enter UPI ID">

    <br><br>
    <button class="btn" onclick="startWithdraw()">Confirm</button>
  </div>
</div>

<!-- STATUS POPUP -->
<div class="popup" id="statusPopup">
  <div class="card">
    <div id="loader" class="spinner"></div>
    <p id="statusText">Processing...</p>
  </div>
</div>

<script>
// ================= INITIAL DATA =================
let balance = parseFloat(localStorage.getItem("userBalance")) || 500;
let currentLevel = parseInt(localStorage.getItem("withdrawLevel")) || 10;
let withdrawAmount = 0;

document.getElementById("balance").innerText = "‚Çπ" + balance;

// ================= WITHDRAW UI =================
function updateWithdrawUI(){
  let box = document.getElementById("withdraw-options");
  box.innerHTML = "";

  let btn = document.createElement("button");
  btn.className = "btn";
  btn.innerText = "Withdraw ‚Çπ" + currentLevel;
  btn.onclick = ()=>{
    withdrawAmount = currentLevel;
    payPopup.style.display="flex";
  };
  box.appendChild(btn);

  if(currentLevel >= 200){
    let b2 = document.createElement("button");
    b2.className="btn";
    b2.style.marginLeft="10px";
    b2.innerText="Withdraw ‚Çπ300";
    b2.onclick=()=>{
      withdrawAmount=300;
      payPopup.style.display="flex";
    };
    box.appendChild(b2);
  }
}
updateWithdrawUI();

// ================= WITHDRAW PROCESS =================
function startWithdraw(){
  let upi = document.getElementById("upiId").value.trim();
  let method = document.getElementById("method").value;

  if(!upi || !method){
    alert("‚ùå Details ‡§≠‡§∞‡•á‡§Ç");
    return;
  }
  if(!upi.includes("@")){
    alert("‚ùå Invalid UPI");
    return;
  }
  if(balance < withdrawAmount){
    alert("‚ùå Balance ‡§ï‡§Æ ‡§π‡•à");
    return;
  }

  payPopup.style.display="none";
  statusPopup.style.display="flex";
  loader.style.display="block";
  statusText.innerText="‚è≥ Processing...";

  // PENDING
  setTimeout(()=>{
    statusText.innerText="üîî Pending";
  },1500);

  // SUCCESS
  setTimeout(()=>{
    loader.style.display="none";
    statusText.innerText="‚úÖ Payment Successful";

    balance -= withdrawAmount;
    localStorage.setItem("userBalance",balance);
    document.getElementById("balance").innerText="‚Çπ"+balance;

    if(currentLevel==10) currentLevel=30;
    else if(currentLevel==30) currentLevel=50;
    else if(currentLevel==50) currentLevel=100;
    else if(currentLevel==100) currentLevel=200;

    localStorage.setItem("withdrawLevel",currentLevel);

    setTimeout(()=>{
      statusPopup.style.display="none";
      location.reload();
    },2000);

  },3500);
}
</script>

</body>
</html>
